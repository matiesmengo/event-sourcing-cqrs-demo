{
  "uid": "kafka-monitoring",
  "title": "Kafka Monitoring",
  "tags": [
    "kafka",
    "monitoring",
    "micrometer"
  ],
  "timezone": "browser",
  "refresh": "10s",
  "time": {
    "from": "now-1h",
    "to": "now"
  },
  "panels": [
    {
      "type": "stat",
      "title": "Records Processats per Client Group",
      "gridPos": {
        "x": 0,
        "y": 0,
        "w": 12,
        "h": 6
      },
      "targets": [
        {
          "expr": "sum by (client_group) (label_replace(kafka_consumer_fetch_manager_records_consumed_total, \"client_group\", \"$1\", \"client_id\", \"(.*)-\\\\d+$\"))",
          "legendFormat": "{{client_group}}",
          "refId": "A"
        }
      ],
      "options": {
        "colorMode": "value",
        "graphMode": "area"
      }
    },
    {
      "type": "stat",
      "title": "Records Processats per Segon (Rate) per Client Group",
      "gridPos": {
        "x": 12,
        "y": 0,
        "w": 12,
        "h": 6
      },
      "targets": [
        {
          "expr": "sum by (client_group) (label_replace(kafka_consumer_fetch_manager_records_consumed_rate, \"client_group\", \"$1\", \"client_id\", \"(.*)-\\\\d+$\"))",
          "legendFormat": "{{client_group}}",
          "refId": "B"
        }
      ],
      "options": {
        "colorMode": "value",
        "graphMode": "area"
      }
    },
    {
      "type": "stat",
      "title": "Bytes Processats Totals per Client Group",
      "gridPos": {
        "x": 0,
        "y": 6,
        "w": 12,
        "h": 6
      },
      "targets": [
        {
          "expr": "sum by (client_group) (label_replace(kafka_consumer_fetch_manager_bytes_consumed_total, \"client_group\", \"$1\", \"client_id\", \"(.*)-\\\\d+$\"))",
          "legendFormat": "{{client_group}}",
          "refId": "C"
        }
      ],
      "options": {
        "colorMode": "value",
        "graphMode": "area"
      }
    },
    {
      "type": "stat",
      "title": "Bytes Processats per Segon (Rate) per Client Group",
      "gridPos": {
        "x": 12,
        "y": 6,
        "w": 12,
        "h": 6
      },
      "targets": [
        {
          "expr": "sum by (client_group) (label_replace(kafka_consumer_fetch_manager_bytes_consumed_rate, \"client_group\", \"$1\", \"client_id\", \"(.*)-\\\\d+$\"))",
          "legendFormat": "{{client_group}}",
          "refId": "D"
        }
      ],
      "options": {
        "colorMode": "value",
        "graphMode": "area"
      }
    },
    {
      "type": "gauge",
      "title": "Records Pendents (Max Lag) per Client Group",
      "gridPos": {
        "x": 0,
        "y": 18,
        "w": 12,
        "h": 6
      },
      "targets": [
        {
          "expr": "max by (client_group) (label_replace(kafka_consumer_fetch_manager_records_lag_max, \"client_group\", \"$1\", \"client_id\", \"(.*)-\\\\d+$\"))",
          "legendFormat": "{{client_group}}",
          "refId": "G"
        }
      ],
      "options": {
        "min": 0,
        "max": 1000,
        "thresholds": [
          {
            "color": "green",
            "value": 0
          },
          {
            "color": "orange",
            "value": 500
          },
          {
            "color": "red",
            "value": 800
          }
        ]
      }
    },
    {
      "type": "stat",
      "title": "Errors per Listener",
      "gridPos": {
        "x": 12,
        "y": 18,
        "w": 12,
        "h": 6
      },
      "targets": [
        {
          "expr": "sum by (listener) (kafka_consumer_exceptions_total)",
          "legendFormat": "{{listener}}",
          "refId": "H"
        }
      ],
      "options": {
        "colorMode": "value",
        "graphMode": "area"
      }
    }
  ],
  "editable": true,
  "schemaVersion": 30,
  "version": 1
}
